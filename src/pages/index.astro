---
import Layout from "../layouts/Layout.astro";
import SEO from "../components/SEO.astro";
import Hero from "../components/Hero.astro";
import tour from "../data/tour.json";

const today = new Date();
const upcoming = (tour as any[])
  .filter((e) => new Date(e.date) >= today)
  .sort((a, b) => new Date(a.date).getTime() - new Date(b.date).getTime())
  .slice(0, 3);

const fmt = (d: string) =>
  new Date(d).toLocaleDateString("nl-NL", { day: "2-digit", month: "long", year: "numeric" });

// JSON-LD voor events (alleen als er shows zijn)
const eventsLd = upcoming.map((e) => ({
  "@context": "https://schema.org",
  "@type": "MusicEvent",
  name: e.title ?? `BJORNOS @ ${e.venue ?? "tba"}`,
  startDate: e.date, // ISO 8601 in je JSON aanhouden
  eventStatus: "https://schema.org/EventScheduled",
  performer: { "@type": "MusicGroup", name: "BJORNOS" },
  location: {
    "@type": "Place",
    name: e.venue ?? "tba",
    address: {
      "@type": "PostalAddress",
      addressLocality: e.city ?? "Utrecht",
      addressCountry: "NL"
    }
  },
  offers: e.tickets ? [{
    "@type": "Offer",
    url: e.tickets,
    availability: "https://schema.org/InStock"
  }] : undefined
}));
---

<Layout>
  <SEO
    title="BJORNOS — House DJ in Utrecht"
    description="Utrechtse House DJ. Energie, flow en strak mixwerk voor clubs, festivals en events. Boek BJORNOS."
    ogImage="/og-home.jpg"
  />

  {upcoming.length > 0 && (
    <script type="application/ld+json">{JSON.stringify(eventsLd)}</script>
  )}

  <Hero />

  <!-- Over mij (teaser) -->
  <section class="section">
    <div class="container-px grid items-start gap-10 md:grid-cols-2">
      <div data-reveal>
        <h2 class="text-white">Over mij</h2>
        <p class="mt-4 max-w-prose">
          Ik draai energieke, doordachte EDM met focus op flow, verrassende wendingen en strak mixwerk.
          Elke set is anders: van diepe rollers tot explosieve bangers — altijd met gevoel voor timing en publiek.
        </p>
        <div class="mt-6 flex gap-3">
          <a href="/about" class="btn btn-ghost">Meer over mij</a>
          <a href="/music" class="btn btn-primary">Luister sets</a>
        </div>
      </div>

      <div data-reveal data-delay="0.1" class="surface p-6">
        <h3 class="text-white">Boekingen</h3>
        <p class="mt-3 text-white/80">
          Beschikbaar voor clubs, festivals en private events. Gevestigd in Utrecht.
        </p>
        <a href="/contact" class="btn btn-primary mt-5 inline-flex">Book Me</a>
      </div>
    </div>
  </section>


  <!-- Blog teaser -->
  <section class="section">
    <div class="container-px surface p-6" data-reveal>
      <div class="flex flex-col gap-3 md:flex-row md:items-center md:justify-between">
        <div>
          <h2 class="text-white">Updates / Blog</h2>
          <p class="text-white/70">Laatste nieuws, set-recaps en gedachten over House.</p>
        </div>
        <div class="mt-4 md:mt-0">
          <a href="/blog" class="btn btn-ghost">Naar blog</a>
        </div>
      </div>
    </div>
  </section>
</Layout>
